{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/dns-over-https","result":{"data":{"markdownRemark":{"id":"688776d2-fdbc-5641-ae6a-6241897a889d","html":"<p>DNS requests are usually made over UDP, in plaintext. In a bid to <strong>introduce more privacy</strong> in DNS traffic, DNS-over-HTTPS (DoH) was published in Oct 2018 (<a href=\"https://tools.ietf.org/html/rfc8484\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RFC 8484</a>). The DNS traffic will be encrypted, and appear to be like normal HTTPS traffic.</p>\n<p>Companies are marketing DoH as a way to prevent ISPs from tracking users’ web traffic, and as a way to bypass censorship in (some) countries. However, there is more to this story…</p>\n<h3 id=\"doh-doesnt-actually-prevent-isps-from-tracking-your-traffic\" style=\"position:relative;\"><a href=\"#doh-doesnt-actually-prevent-isps-from-tracking-your-traffic\" aria-label=\"doh doesnt actually prevent isps from tracking your traffic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DoH doesn’t actually prevent ISPs from tracking your traffic!</h3>\n<ul>\n<li>Yes, your DNS traffic remains encrypted… but</li>\n<li>For HTTP traffic, the destination site is in plaintext</li>\n<li>For HTTPS traffic, the ISP can look at the <a href=\"https://www.cloudflare.com/learning/ssl/what-is-sni/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Server Name Identification (SNI)</a> field, which is where the client indicates the hostname it wants to connect to during the TLS handshake. (The SNI field is an optional extension of TLS)</li>\n<li>Of course, people have also proposed <a href=\"https://datatracker.ietf.org/doc/draft-ietf-tls-esni/history/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">encrypting the SNI field</a>.</li>\n</ul>\n<h3 id=\"doh-has-implications-on-security-policies-and-could-benefit-the-wrong-people\" style=\"position:relative;\"><a href=\"#doh-has-implications-on-security-policies-and-could-benefit-the-wrong-people\" aria-label=\"doh has implications on security policies and could benefit the wrong people permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DoH has implications on security policies, and could benefit the wrong people</h3>\n<ul>\n<li>Since DNS traffic is now encrypted, companies will find it harder to implement security policies (e.g. no facebook at work), possibly facilitating the spread of malware.</li>\n<li>Example: The malware <a href=\"https://www.bleepingcomputer.com/news/security/new-godlua-malware-evades-traffic-monitoring-via-dns-over-https/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Godlua</a> has abused DoH to communicate with its command and control without being easily detected.</li>\n<li>Example: It would be <a href=\"https://news.sky.com/story/googles-chrome-browser-plans-risk-undermining-fight-against-online-child-abuse-govt-warned-11734166\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">harder to filter content like child abuse</a>.</li>\n</ul>\n<h4 id=\"so-given-these-concerns-do-we-forego-dns-over-https\" style=\"position:relative;\"><a href=\"#so-given-these-concerns-do-we-forego-dns-over-https\" aria-label=\"so given these concerns do we forego dns over https permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>So, given these concerns, do we forego DNS-over-HTTPS?</h4>\n<ul>\n<li>DNS-over-HTTPS has roused the security community, but the general concensus seems to be that its benefits have been overstated.</li>\n<li>There are other proposals like DNSSEC (<a href=\"https://tools.ietf.org/html/rfc4033\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RFC 4033</a>) and DNS-over-TLS (DoT, <a href=\"https://tools.ietf.org/html/rfc7858\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RFC 7858</a>), <a href=\"https://en.wikipedia.org/wiki/DNSCrypt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DNSCrypt</a>, but these also have their own security concerns.</li>\n<li>Privacy in our DNS traffic is important, and this is currently still a work in progress in security research!</li>\n</ul>\n<h3 id=\"readings\" style=\"position:relative;\"><a href=\"#readings\" aria-label=\"readings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Readings</h3>\n<p><a href=\"https://www.zdnet.com/article/dns-over-https-causes-more-problems-than-it-solves-experts-say/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A quick read</a>\n<a href=\"https://blog.apnic.net/2019/10/03/opinion-centralized-doh-is-bad-for-privacy-in-2019-and-beyond/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">An elaborate discussion on privacy; also contains information on metadata leaks like SNI</a></p>\n<p>I do recommend reading and comparing the different schemes proposed to introduce privacy in DNS traffic.</p>","fields":{"slug":"/posts/dns-over-https","tagSlugs":["/tag/smtp/"]},"frontmatter":{"date":"2019-10-10","description":"A great idea but doesn't seem to achieve what it set out to do","tags":["smtp"],"title":"DNS-over-HTTPS"}}},"pageContext":{"slug":"/posts/dns-over-https"}},"staticQueryHashes":["251939775","3439816877","401334301"]}