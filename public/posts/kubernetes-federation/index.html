<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.8bcb15280dd087872d46.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--Yrism{color:#222}.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.625rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#5d93ff}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--Efbin{margin-bottom:1.625rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:2.03125rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--3nigr{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--2nMky{margin-bottom:3.25rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--Ic6i6{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:3.25rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:40rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.625rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:40rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.8125rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#5d93ff}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:40rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.29.3"/><link rel="alternate" type="application/rss+xml" title="Joyce Yeo" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id="></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=2901374841874cd528f6c23cefb75e3e" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=2901374841874cd528f6c23cefb75e3e"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=2901374841874cd528f6c23cefb75e3e"/><title data-react-helmet="true">Kubernetes Cluster Federation - Joyce Yeo</title><meta data-react-helmet="true" name="description" content="Multi-cluster orchestration"/><meta data-react-helmet="true" property="og:site_name" content="Kubernetes Cluster Federation - Joyce Yeo"/><meta data-react-helmet="true" property="og:image" content="https://joyceyeo.netlify.app/photo.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Kubernetes Cluster Federation - Joyce Yeo"/><meta data-react-helmet="true" name="twitter:description" content="Multi-cluster orchestration"/><meta data-react-helmet="true" name="twitter:image" content="https://joyceyeo.netlify.app/photo.jpg"/><link as="script" rel="preload" href="/webpack-runtime-86b7e573ecc0f63b86e5.js"/><link as="script" rel="preload" href="/framework-f0fa8831b6d960814d9c.js"/><link as="script" rel="preload" href="/532a2f07-5d61e092ba8c45c5c11a.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-d743a9af41120ad88de2.js"/><link as="script" rel="preload" href="/app-c3dc184b6a1bdd830d99.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-73792d2496c1cedff2b5.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-590414f8b47d5d869713.js"/><link as="fetch" rel="preload" href="/page-data/posts/kubernetes-federation/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3439816877.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Kubernetes Cluster Federation</h1><div class="Content-module--content__body--2TrQ-"><h3 id="kubernetes-clusters-as-an-aggregation-of-resources" style="position:relative;"><a href="#kubernetes-clusters-as-an-aggregation-of-resources" aria-label="kubernetes clusters as an aggregation of resources permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kubernetes clusters as an aggregation of resources</h3>
<p>When we are running a small company, we might just run our scripts on a single machine. As our operations scale, we would buy more machines to run them. At this point, we are able to optimise how we run tasks - for example, assigning short tasks to one machine while letting another run a difficult task. Alternatively, we might let one machine rest for maintenance works, and reschedule all its pending tasks to another.</p>
<p>The key idea? Multiple instances of computing power allow us to plan how we run our tasks, while also providing a redundancy buffer. When a system grows large enough to say hundreds of machines, we might group them together to a cluster, which is what a <strong>kubernetes</strong> cluster aims to do.</p>
<p>A cluster is simply a group of machine nodes, providing the benefits of combining resources together. We can call this a <strong>federation</strong> of nodes, with a brain like kube-controller to decide how resources should be allocate within this grouping.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 355px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/802f69bebce8b697d0bc0bce8d944fae/526ee/cloud-node-fed.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACNElEQVQ4y5VTaW/aQBDl//+IqqitokaJhNI2Lc2HVBSJNCIpoQ3IhNvGYPBtbHy/7myziDhUDZZGs57j7ZtjS3j8sizj+uamidflMj6cVXBycop6vY6jd29x9P4Y1eoXvCm/wvFpBbVaDeljTp7nAgYlcRDGNE3heR4X13W5nbTrCpvD9BpBEGxz9gIWHS/9ijnPGJImSdMMCWObJAVhtizLt3EvYhgnGTqyD0mN8LBI0OMSs3PM7BuoRvjPivYChnGK7izExdUDzi5/4qIh4fP33zhn0hr5UM34MMA4zXE3sFCt3+Pj5S3Oa7/w6VsLla/XqLUUzK3kMMCIldwaemjca7jqaPjR1XHbt1G/U9Do6FCM6DBA2q+VE8HwUtgBIGsulnYIK8iZPYEX/Kfk3WllO9MT33g8ZPtnP7GJST+bshh/ESSMIui6jtVqBVmWMZ/PsVwu+YLvxhbzn5RMr2Q2m3EQAvN9n9vb7TYcx+Fn27a5X1VVfi62rBTHMRaLBTRNg2maaDabLHjGGVGSxZJ6vR40FjNn/yK22+lAkiT+HCeTCcLw726WNpsNv5He62g84knUn+l0yliu4FgGxhOZAWlYr9c8mZhTjqIoMAyDMyXfFpDKIz0cDTEYDLiDgk3TgO85kHp9xniBDWNBFxEbYjro92GzVhCZLSCVTCWQUJ/oNrqAyiUxWBscx+Y+6q8omeJILMvil29LFs1MkgQETkJnvkJsH4WNhIYmhrfPTjl/AGdVGDyB0mDtAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/802f69bebce8b697d0bc0bce8d944fae/8ac56/cloud-node-fed.webp 240w,
/static/802f69bebce8b697d0bc0bce8d944fae/918eb/cloud-node-fed.webp 355w"
          sizes="(max-width: 355px) 100vw, 355px"
          type="image/webp"
        />
        <source
          srcset="/static/802f69bebce8b697d0bc0bce8d944fae/8ff5a/cloud-node-fed.png 240w,
/static/802f69bebce8b697d0bc0bce8d944fae/526ee/cloud-node-fed.png 355w"
          sizes="(max-width: 355px) 100vw, 355px"
          type="image/png"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/802f69bebce8b697d0bc0bce8d944fae/526ee/cloud-node-fed.png"
          alt="Node Federation"
          title="Node Federation"
          loading="lazy"
          style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        />
      </picture>
  </a>
    </span></p>
<h3 id="managing-multiple-kubernetes-clusters" style="position:relative;"><a href="#managing-multiple-kubernetes-clusters" aria-label="managing multiple kubernetes clusters permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Managing multiple kubernetes clusters</h3>
<p>Suppose then, that we want to scale our operations even further, managing multiple kubernetes clusters. Why would we do that? We could run clusters in different data centers, different cloud providers (e.g. one cluster in AKS, one in GKE) or simply as a redundancy in case the cluster brain (control plane) breaks down. </p>
<p>Another common reason for deploying many clusters is due to the <strong>limited vertical scalability of kubernetes clusters</strong>. As we add more nodes to a cluster, its performance will degrade for a variety of reasons - such as the scheduler simply having to store information on more machines.</p>
<p>As such, we would turn to <strong>horziontally scaling</strong> kubernetes, by creating more clusters. These clusters can get hard to manage over time, giving rise to the need for <strong>multi-cluster orchestration</strong>. That is, given a task to run, we would first select the cluster we want to run it in, among many clusters we have. </p>
<p>The selection criteria might include:</p>
<ul>
<li>whether it is suitable to run the task in the cluster (e.g. the machine type)</li>
<li>whether we want to spread resource use evenly between clusters, or</li>
<li>whether we want to distribute redundant replicas of the same service across multiple clusters.</li>
</ul>
<p>Key Cloud Native Computing Foundation (CNCF) projects targeting this issue include Karmada and KubeFed. This article aims to highlight some issues about multi-cluster orchestration, particularly using the point-of-view of KubeFed.</p>
<h2 id="kubefed" style="position:relative;"><a href="#kubefed" aria-label="kubefed permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>KubeFed</h2>
<p>A federated k8s control plane is the brain behind co-ordinating how resources are distributed and executed on multiple clusters. This service will be called the “fedbrain” in here, for brevity and also because it does sound catchy. </p>
<p>The fedbrain is responsible for two key tasks.</p>
<ol>
<li><strong>Resource Scheduling</strong>. The fedbrain must decide how resources are distributed to different clusters.</li>
<li><strong>Status Aggregation</strong>. The fedbrain must have a mechanism to determine when the resources have been successfully distributed to the various clusters.</li>
</ol>
<h4 id="kubernetes-native-api" style="position:relative;"><a href="#kubernetes-native-api" aria-label="kubernetes native api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kubernetes-Native API</h4>
<p>Ideally, users do not want to make additional adaptations in order to start using the fedbrain. For instance, I was previously running an identical <code class="language-text">Deployment</code> on four kubernetes clusters. When I use fedbrain, I just want to send it the <code class="language-text">Deployment</code> as I would to any cluster. Then, I would expect it to do the multi-cluster distribution on my behalf. </p>
<p>An external user should be <strong>agnostic</strong> to the fact that a cluster might be a regular cluster or a federated cluster. As such, the federated cluster should work just the same as a regular cluster.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 486px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ab8312ed331c25a9dceb2bbd61816c8b/4ee7f/cloud-cluster-fed.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB80lEQVQ4y42T23LaMBCGef8HaTO960U6QDuhaag5GUjBB3AMxJiSgRRsbMDYlv1nJSBAoUk1s6O1tPvtv5KVwdFI01TMtvUIuV5HuVyGpmlQ2i2UyhW0aZYkCaZpIo7ZSc5+ZC4BhwQsFovIZrNoNBpQCZTPf0WpJCGfyxG4jSiK3wdeCnhrXIo9U3iwBCz0kbIlwFY0r8AiDwkLwTl72Lst7wOSeA34TXi/f2BmFeCMbpE4ZSTrIVL8J/A4IGVrBFMJeu0T7qUPaP78iCfjmoDWCfBiy6etptsEAvpPd5hb3+DYBbhks0EO0XLwCjyYoAg/8/ZlMLA4gDt/FjMQi8R/dsWBx6AoDBFHETzPg+u6ZAv4/hIPDyYcx8VCrC/EXkixYbg5O0uhcBPGaOgjXH2+gdEfkZoIIYHThGEyX+P6RoasPiKinzmidW4eFcp9r+FLoY7R1D8o3Kurazbu6j34QbLb3K4/uwFuawZaxvis1a41Q6HSwfjP6gDcbDYwDEpo/YIsy9B1HXPHEQGTyQQd+q5Wq9BUdffkYjDGhK/SWoWep9HtYjzeFsxMp1PxXnWyTqeL+2YTQ9sWbQ36fSrURq9nQlEUUcyh8/N9j2AK7bWEGHVXjOdkeEWuklsQBK8+l7/3txaKfa6OG/f5xfyd8wK1vy2so7d1hgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
        <source
          srcset="/static/ab8312ed331c25a9dceb2bbd61816c8b/8ac56/cloud-cluster-fed.webp 240w,
/static/ab8312ed331c25a9dceb2bbd61816c8b/d3be9/cloud-cluster-fed.webp 480w,
/static/ab8312ed331c25a9dceb2bbd61816c8b/aba12/cloud-cluster-fed.webp 486w"
          sizes="(max-width: 486px) 100vw, 486px"
          type="image/webp"
        />
        <source
          srcset="/static/ab8312ed331c25a9dceb2bbd61816c8b/8ff5a/cloud-cluster-fed.png 240w,
/static/ab8312ed331c25a9dceb2bbd61816c8b/e85cb/cloud-cluster-fed.png 480w,
/static/ab8312ed331c25a9dceb2bbd61816c8b/4ee7f/cloud-cluster-fed.png 486w"
          sizes="(max-width: 486px) 100vw, 486px"
          type="image/png"
        />
        <img
          class="gatsby-resp-image-image"
          src="/static/ab8312ed331c25a9dceb2bbd61816c8b/4ee7f/cloud-cluster-fed.png"
          alt="Cluster Federation"
          title="Cluster Federation"
          loading="lazy"
          style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        />
      </picture>
  </a>
    </span></p>
<h4 id="federatedx" style="position:relative;"><a href="#federatedx" aria-label="federatedx permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FederatedX</h4>
<p>The federation might have to store some information in the control plane, such as how a resource was distributed previously. This would facilitate future actions like updates or deletions. </p>
<p>The resource might be called <code class="language-text">FederatedX</code>. For example, we could have <code class="language-text">ConfigMap</code> and <code class="language-text">FederatedConfigMap</code>, <code class="language-text">Deployment</code> and the corresponding <code class="language-text">FederatedDeployment</code>. </p>
<p>Since kubernetes supports large variety of resources, including self-written custom resource definitions (CRDs), the fedbrain needs to be flexible enough to accomodate both standard and non-standard resources. Standard resources include <code class="language-text">Deployments</code>, <code class="language-text">Secrets</code> and <code class="language-text">ConfigMap</code>. Non-standard resources can literally include anything.</p>
<p>With so many resources, there will be too many <code class="language-text">FederatedX</code> resource types to define, so we might want to use a standardised and universal <code class="language-text">FederatedX</code> object that embeds multiple types of resources. This variability can be achieved via the <code class="language-text">x-kubernetes-preserve-unknown-fields</code> property of CRDs. Doing so also allows for future additions of CRDs without having to support the corresponding logic in the control plane.</p>
<h4 id="template-placement-overrides" style="position:relative;"><a href="#template-placement-overrides" aria-label="template placement overrides permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Template, Placement, Overrides</h4>
<p>The generic structure of a <code class="language-text">FederatedX</code> object would include three properties.</p>
<p><strong>Template</strong>. Contains the original object that we want to propagate to the various clusters.</p>
<p><strong>Placement</strong>. Contains the scheduling result of which clusters the object should be propagated to.</p>
<p><strong>Overrides</strong>. With the current structure, we can only propagate the same template object to every cluster. However, we might want to override some fields like the number of replicas, or some cluster-specific labels. Overrides allow us to propagate slightly altered versions of the template.</p>
<h4 id="cluster-selection" style="position:relative;"><a href="#cluster-selection" aria-label="cluster selection permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cluster Selection</h4>
<p>Suppose we have three clusters available to schedule <code class="language-text">10</code> replicas of an application. How do we decide the ratio of replica division? We can take a leaf from how kubernetes clusters themselves work.</p>
<p>When a kubernetes cluster has hundreds of machines, the <code class="language-text">kube-scheduler</code> makes decisions of which machines a task should run on. It might consider some machine labels, for instance certain machines might be reserved for premium users. It might also consider the resource available on each machine.</p>
<p>Similarly, the fedbrain can extract information on cluster suitability and resource availability to decide which clusters should be selected.</p>
<p>Some services are stateful, and rely on persistent local data stored on a particular machine. In these cases, it is necessary to ensure that the scheduling (1) always selects the same member cluster and (2) always selects the same node within the cluster. Criterion (1) must be fulfilled by the fedbrain, meaning it needs to know when a task requires a static cluster placement. Criterion (2) is already achieved by the native <code class="language-text">kube-scheduler</code>, through Persistent Volume Claim (PVC) bindings.</p>
<h4 id="federation-flow" style="position:relative;"><a href="#federation-flow" aria-label="federation flow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Federation Flow</h4>
<p>With these concepts set up, we can construct the flow of information between the external user, fedbrain and the constituent member clusters.</p>
<ol>
<li>User sends fedbrain an object.</li>
<li>Fedbrain “federates” the object, constructing its <code class="language-text">FederatedX</code> variant.</li>
<li>Based on some scheduling rules, fedbrain selects clusters to propagate the object to, and determine the ratio of propagation.</li>
<li>Fedbrain aggregates the status of the propagation from every cluster, and records and intermediate status in the <code class="language-text">FederatedX</code> object. This status would facilitate any re-scheduling. For instance if one cluster is not responsive we might want to reduce its replicas.</li>
<li>Fedbrain converts the federated status and writes it back to the original object.</li>
<li>The user perceives that the status of the original object is as desired, and is assured that the propagation has been successful.</li>
</ol>
<h2 id="remarks" style="position:relative;"><a href="#remarks" aria-label="remarks permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remarks</h2>
<p>Here is a <a href="https://www.youtube.com/watch?v=kwOvOLnFYck&#x26;ab_channel=CNCF%5BCloudNativeComputingFoundation%5D" target="_blank" rel="nofollow noopener noreferrer">short video</a> that aptly summarises what cluster federation is.</p>
<p>We started with node federation (i.e. a kubernetes cluster). Here, we discuss cluster federation (i.e. a group of clusters). Could we then further extend the concept to a federation of federations? </p>
<p>While multi-cluster orchestration can be beneficial, we have to be certain why we want to even adopt such a complex architecture in the first place. It is important to assess the nature of the use scenario. Simple solutions work the best.</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Feb 13, 2023</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/kubernetes/">kubernetes</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/federation/">federation</a></li></ul></div><div class="Author-module--author--2Yefr"><p>All up for puzzles and games. Well-versed in Python, Golang. <a href="https://www.twitter.com/pikulet" rel="noopener noreferrer" target="_blank">Find me on GitHub</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/kubernetes-federation";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9f4f178102f0a56754ae.js"],"app":["/app-c3dc184b6a1bdd830d99.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-80d7889eeb6395877420.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-ca748dd912acdce40443.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-658f4507169e2836a377.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-3f44b90abaee160142f0.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-590414f8b47d5d869713.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-4ec669dfbc1ce8819e34.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-9f4f178102f0a56754ae.js" nomodule=""></script><script src="/component---src-templates-post-template-js-590414f8b47d5d869713.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-73792d2496c1cedff2b5.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-c3dc184b6a1bdd830d99.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-d743a9af41120ad88de2.js" async=""></script><script src="/532a2f07-5d61e092ba8c45c5c11a.js" async=""></script><script src="/framework-f0fa8831b6d960814d9c.js" async=""></script><script src="/webpack-runtime-86b7e573ecc0f63b86e5.js" async=""></script></body></html>